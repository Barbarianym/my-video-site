<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Responsive Video Player</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background-color: black;
    overflow: hidden;
    height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  }

  /* Video full screen */
  video {
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1;
    background: #000;
  }

  /* Loader */
  .loader-container {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    z-index: 3;
    color: white;
    background: rgba(0,0,0,0.4);
    padding: 20px 30px;
    border-radius: 12px;
  }

  .loader {
    border: 6px solid rgba(255,255,255,0.2);
    border-top: 6px solid #3498db;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    animation: spin 1s linear infinite;
    margin: 0 auto 10px auto;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Navigation buttons */
  #prevVideoButton, #nextVideoButton {
    position: fixed;
    padding: 15px 30px;
    font-size: 16px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    background: rgba(0,0,0,0.5);
    color: white;
    z-index: 4;
    transition: background 0.2s;
  }
  #prevVideoButton:hover, #nextVideoButton:hover {
    background: rgba(0,0,0,0.8);
  }

  #prevVideoButton { bottom: 8%; left: 25%; transform: translate(-50%, -50%); }
  #nextVideoButton { bottom: 8%; left: 75%; transform: translate(-50%, -50%); }

  /* Sound toggle icon */
  #soundToggle {
    position: fixed;
    top: 15px;
    left: 15px;
    width: 42px;
    height: 42px;
    z-index: 5;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    color: white;
    background: rgba(0,0,0,0.4);
    border-radius: 50%;
    user-select: none;
  }

  /* âœ… Responsive adjustments for mobile */
  @media (max-width: 768px) {
    video {
      height: 100dvh; /* dynamic height for iPhone */
    }

    #soundToggle {
      top: calc(env(safe-area-inset-top, 0px) + 10px);
      left: calc(env(safe-area-inset-left, 0px) + 10px);
      width: 48px;
      height: 48px;
      font-size: 26px;
    }

    #prevVideoButton, #nextVideoButton {
      font-size: 14px;
      padding: 12px 20px;
      bottom: calc(env(safe-area-inset-bottom, 0px) + 60px);
    }

    #prevVideoButton { left: 22%; }
    #nextVideoButton { left: 78%; }
  }
</style>
</head>
<body>

<video id="autoVideo" playsinline autoplay muted></video>

<div class="loader-container" id="loaderContainer">
  <div class="loader"></div>
  <div id="loaderText">Loading video...</div>
</div>

<button id="prevVideoButton">Previous</button>
<button id="nextVideoButton">Next</button>

<div id="soundToggle">ðŸ”‡</div>

<script>
  const video = document.getElementById('autoVideo');
  const loaderContainer = document.getElementById('loaderContainer');
  const loaderText = document.getElementById('loaderText');
  const prevButton = document.getElementById('prevVideoButton');
  const nextButton = document.getElementById('nextVideoButton');
  const soundToggle = document.getElementById('soundToggle');

  const videoPlaylist = [
    './videos/myvideo.mp4',
    './videos/myvideo2.mp4'
  ];

  let currentIndex = 0;
  let hasStarted = false;
  let isBuffering = false;
  let lastTime = 0;
  let checkInterval;

  function showLoader(show, text = 'Loading video...') {
    loaderText.textContent = text;
    loaderContainer.style.display = show ? 'block' : 'none';
  }

  function getViewCount(name) {
    return parseInt(localStorage.getItem('viewCount_' + name) || '0', 10);
  }
  function incView(name) {
    const v = getViewCount(name) + 1;
    localStorage.setItem('viewCount_' + name, v);
    return v;
  }

  function loadVideo(i) {
    if (i < 0 || i >= videoPlaylist.length) return;
    currentIndex = i;
    const src = videoPlaylist[i];
    video.src = src;
    video.muted = true;
    soundToggle.textContent = 'ðŸ”‡';
    showLoader(true);
    hasStarted = false;
    isBuffering = false;
    lastTime = 0;
    video.play().catch(() => {});
    updateButtons();

    if (checkInterval) clearInterval(checkInterval);
    checkInterval = setInterval(() => {
      if (!video.paused && video.readyState > 2) {
        if (video.currentTime > lastTime + 0.05) {
          if (!hasStarted) {
            hasStarted = true;
            showLoader(false);
            incView(src.split('/').pop());
          }
          if (isBuffering) {
            isBuffering = false;
            showLoader(false);
          }
          lastTime = video.currentTime;
        }
      }
    }, 200);
  }

  function updateButtons() {
    if (videoPlaylist.length === 1) {
      prevButton.style.display = 'none';
      nextButton.style.display = 'none';
    } else {
      prevButton.style.display = currentIndex === 0 ? 'none' : 'inline-block';
      nextButton.style.display = currentIndex === videoPlaylist.length - 1 ? 'none' : 'inline-block';
    }
  }

  video.addEventListener('waiting', () => {
    if (hasStarted) {
      isBuffering = true;
      showLoader(true, 'Buffering...');
    }
  });

  video.addEventListener('ended', () => {
    loadVideo((currentIndex + 1) % videoPlaylist.length);
  });

  soundToggle.addEventListener('click', () => {
    video.muted = !video.muted;
    soundToggle.textContent = video.muted ? 'ðŸ”‡' : 'ðŸ”Š';
    if (!video.muted) video.play().catch(() => {});
  });

  prevButton.addEventListener('click', () => {
    loadVideo((currentIndex - 1 + videoPlaylist.length) % videoPlaylist.length);
  });

  nextButton.addEventListener('click', () => {
    loadVideo((currentIndex + 1) % videoPlaylist.length);
  });

  loadVideo(0);
</script>
</body>
</html>


