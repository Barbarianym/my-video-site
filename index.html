<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Autoplay Video</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background-color: black;
      overflow: hidden;
      height: 100%;
    }
    video {
      width: 100vw;
      height: 100vh;
      object-fit: cover;
    }
    button {
      position: fixed;
      padding: 15px 30px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    #tapPlayButton {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
    }
    #prevVideoButton {
      top: 85%;
      left: 25%;
      transform: translate(-50%, -50%);
      background: gray;
      color: white;
    }
    #nextVideoButton {
      top: 85%;
      left: 75%;
      transform: translate(-50%, -50%);
      background: gray;
      color: white;
    }
  </style>
</head>
<body>
  <video id="autoVideo" playsinline autoplay loop></video>
  <button id="tapPlayButton">Tap to Play with Sound</button>
  <button id="prevVideoButton">Watch Previous Video</button>
  <button id="nextVideoButton">Watch Next Video</button>

  <script>
    const video = document.getElementById('autoVideo');
    const tapPlayButton = document.getElementById('tapPlayButton');
    const prevButton = document.getElementById('prevVideoButton');
    const nextButton = document.getElementById('nextVideoButton');

    // ---------------------------
    // Playlist of videos
    // ---------------------------
    const videoPlaylist = [
      './videos/myvideo.mp4',
      './videos/myvideo2.mp4',
      './videos/myvideo3.mp4'
    ];

    let currentIndex = 0;

    // Hidden counter for each video
    const tapCounts = videoPlaylist.map(() => 0);

    // ---------------------------
    // Load video function
    // ---------------------------
    function loadVideo(index) {
      if (index < 0 || index >= videoPlaylist.length) return;
      currentIndex = index;
      video.src = videoPlaylist[currentIndex];
      video.load();
      video.muted = true; // autoplay muted first
      tryAutoplay();
      tapPlayButton.style.display = 'inline-block'; // reset button for new video
    }

    // ---------------------------
    // Try autoplay muted
    // ---------------------------
    async function tryAutoplay() {
      try {
        await video.play();
      } catch (err) {
        // If autoplay with sound blocked, button is already visible
      }
    }

    // ---------------------------
    // Tap to play with sound
    // ---------------------------
    tapPlayButton.addEventListener('click', async () => {
      tapCounts[currentIndex]++; // increment hidden counter
      video.muted = false;
      try {
        await video.play();
        tapPlayButton.style.display = 'none';
      } catch (err) {
        tapPlayButton.style.display = 'inline-block';
      }
    });

    // ---------------------------
    // Next video button
    // ---------------------------
    nextButton.addEventListener('click', () => {
      if (currentIndex < videoPlaylist.length - 1) {
        loadVideo(currentIndex + 1);
      } else {
        alert('No more videos to watch right now, come back later.');
      }
    });

    // ---------------------------
    // Previous video button
    // ---------------------------
    prevButton.addEventListener('click', () => {
      if (currentIndex > 0) {
        loadVideo(currentIndex - 1);
      } else {
        alert('This is the first video.');
      }
    });

    // ---------------------------
    // Initialize
    // ---------------------------
    loadVideo(currentIndex);

    // Optional: hidden console log to check counts per video
    // setInterval(() => console.log('Hidden Tap Counts:', tapCounts), 5000);
  </script>
</body>
</html>
